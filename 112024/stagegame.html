<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- UIkit CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/uikit@3.21.16/dist/css/uikit.min.css" />
    <!-- UIkit JS -->
    <script src="https://cdn.jsdelivr.net/npm/uikit@3.21.16/dist/js/uikit.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/uikit@3.21.16/dist/js/uikit-icons.min.js"></script>
    <!-- Chart.JS -->
    <script src="https://www.jsdelivr.com/package/npm/chart.js?path=dist"></script>
    <title>How Do Markets React Under Pressure: A Behavioral Study: Instructions</title>
</head>
<script>
    class tradingData{
        constructor(){
            let params = new URLSearchParams(window.location.search);
            this.arn = "arn:aws:execute-api:ap-southeast-2:412381775962:0igi5rqzti/*/*/group1".split(":");
            this.fn = this.arn[this.arn.length-1].split("/");
            this.lambda_api = `https://${this.fn[0]}.${this.arn[2]}.${this.arn[3]}.amazonaws.com/${this.fn[this.fn.length-1]}`;
        }
        getData(t = 0) {
            console.log(this.lambda_api);
            fetch(`${this.lambda_api}?t=${t}`, {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json',
                },
            })
            .then(response => response.json())
            .then(fluctuations => {
                this.fluctuations = fluctuations;
                console.log('Success:', fluctuations);
            })
            .catch((error) => {
                console.error('Error:', error);
            });
            return this.fluctuations;
        }
    }
    const data = new tradingData();
</script>
<body>
<div class="uk-container uk-margin-top">
    <h1 class="uk-heading">Trading</h1>
    <progress id="js-progressbar" class="uk-progress" value="0" max="100"></progress>

    <ul class="uk-list">
        <li>
            <label>
                <input class="uk-radio" type="radio" name="decision" value="UP"> UP (buy)
            </label>
        </li>
        <li>
            <label>
                <input class="uk-radio" type="radio" name="decision" value="DOWN"> DOWN (sell)
            </label>
        </li>
        <li>
            <label>
                <input class="uk-radio" type="radio" name="decision" value="STAY"> STAY (hold)
            </label>
        </li>
    </ul>

    <button class="uk-button uk-button-primary uk-form-width-medium" id="_submit">Submit</button>

<script>
    localStorage.clear();
    var r = localStorage.getItem('round');
    const bar = document.getElementById('js-progressbar');
    if (r === null){
        data.getData();
        localStorage.setItem('round', 1);
    }
    document.getElementById('_submit').addEventListener('click', (e) => {
        r = parseInt(localStorage.getItem('round'));
        data.getData(r);
        bar.value = r*20;
        r++;
        localStorage.setItem('round', r);
    });

</script>
</body>
</html>